import{_ as D,c as d,a as t,w as m,v as p,t as C,F as y,r as x,u as S,b as E,d as r,o as _,e as z,f as g,n as M}from"./index-PZeQTu1O.js";const R={name:"Create",setup(){const f=S(),a=E(),o=r(null),e=r(null),u=r(!1),c=r("#000000"),l=r(5),i=r(""),h=[{value:"happy",label:"开心"},{value:"sad",label:"难过"},{value:"angry",label:"愤怒"},{value:"peaceful",label:"平静"},{value:"excited",label:"兴奋"},{value:"anxious",label:"焦虑"}];_(()=>{o.value&&(e.value=o.value.getContext("2d"),e.value.fillStyle="#ffffff",e.value.fillRect(0,0,o.value.width,o.value.height))});const k=s=>{u.value=!0,w(s)},w=s=>{if(!u.value)return;const n=o.value.getBoundingClientRect(),v=s.clientX-n.left,b=s.clientY-n.top;e.value.lineWidth=l.value,e.value.lineCap="round",e.value.strokeStyle=c.value,e.value.lineTo(v,b),e.value.stroke(),e.value.beginPath(),e.value.moveTo(v,b)};return{canvas:o,brushColor:c,brushSize:l,selectedEmotion:i,emotions:h,startDrawing:k,draw:w,stopDrawing:()=>{u.value=!1,e.value.beginPath()},clearCanvas:()=>{e.value.clearRect(0,0,o.value.width,o.value.height),e.value.fillStyle="#ffffff",e.value.fillRect(0,0,o.value.width,o.value.height)},selectEmotion:s=>{i.value=s},saveArtwork:async()=>{var s;if(!a.isLoggedIn){window.dispatchEvent(new CustomEvent("open-login-modal"));return}if(!i.value){alert("请先选择一个情绪标签");return}try{const n=o.value.toDataURL("image/png");(await z.post("/artworks",{title:`情绪画作 - ${new Date().toLocaleString()}`,emotion:i.value,imageData:n,userId:(s=a.user)==null?void 0:s.id})).data.success&&(alert("作品保存成功！"),f.push("/gallery"))}catch(n){console.error("保存作品失败:",n),alert("保存失败，请重试")}}}}},A={class:"create-container"},B={class:"create-card"},L={class:"canvas-container"},U={class:"canvas-controls"},F={class:"tool-group"},I={class:"tool-group"},T={class:"tool-group"},V={class:"emotion-selector"},P={class:"emotion-tags"},N=["onClick"];function W(f,a,o,e,u,c){return g(),d("div",A,[a[12]||(a[12]=t("div",{class:"background-decoration"},[t("div",{class:"decoration-circle circle-1"}),t("div",{class:"decoration-circle circle-2"}),t("div",{class:"decoration-circle circle-3"})],-1)),t("div",B,[a[11]||(a[11]=t("div",{class:"create-header"},[t("h1",null,"创作新作品"),t("p",{class:"subtitle"},"用画笔表达您的情绪，创造独特的艺术作品")],-1)),t("div",L,[t("canvas",{ref:"canvas",width:"800",height:"600",class:"drawing-canvas",onMousedown:a[0]||(a[0]=(...l)=>e.startDrawing&&e.startDrawing(...l)),onMousemove:a[1]||(a[1]=(...l)=>e.draw&&e.draw(...l)),onMouseup:a[2]||(a[2]=(...l)=>e.stopDrawing&&e.stopDrawing(...l)),onMouseleave:a[3]||(a[3]=(...l)=>e.stopDrawing&&e.stopDrawing(...l))},null,544),t("div",U,[t("div",F,[a[8]||(a[8]=t("label",null,"画笔颜色",-1)),m(t("input",{type:"color","onUpdate:modelValue":a[4]||(a[4]=l=>e.brushColor=l),class:"color-picker"},null,512),[[p,e.brushColor]])]),t("div",I,[a[9]||(a[9]=t("label",null,"画笔大小",-1)),m(t("input",{type:"range",min:"1",max:"50","onUpdate:modelValue":a[5]||(a[5]=l=>e.brushSize=l),class:"size-slider"},null,512),[[p,e.brushSize]]),t("span",null,C(e.brushSize)+"px",1)]),t("div",T,[t("button",{onClick:a[6]||(a[6]=(...l)=>e.clearCanvas&&e.clearCanvas(...l)),class:"btn btn-secondary"},"清空画布"),t("button",{onClick:a[7]||(a[7]=(...l)=>e.saveArtwork&&e.saveArtwork(...l)),class:"btn btn-primary"},"保存作品")])])]),t("div",V,[a[10]||(a[10]=t("h3",null,"选择您的情绪",-1)),t("div",P,[(g(!0),d(y,null,x(e.emotions,l=>(g(),d("button",{key:l.value,onClick:i=>e.selectEmotion(l.value),class:M(["emotion-tag",{active:e.selectedEmotion===l.value}])},C(l.label),11,N))),128))])])])])}const H=D(R,[["render",W],["__scopeId","data-v-e08c7980"],["__file","C:/Users/Firday1/Desktop/绘画软件/src/views/Create.vue"]]);export{H as default};
